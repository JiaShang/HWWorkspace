<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="GBK"/>
    <meta name="page-view-size" content="1280*720"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no"/>
    <meta http-equiv="X-UA-Compatible" content="ie=edge"/>
    <style>
        .mask{width:346px;position:absolute;background:transparent url("images/mask-2020-New-Hike-CQBY.png") no-repeat 0px 0px; background-position: 0px 0px;}
        .mask1{height:146px;left:94px;top:412px;background-position: 0px 0px;}
        .mask2{height:146px;left:468px;top:411px;background-position: 0px -150px;}
        .mask3{height:146px;left:840px;top:415px;background-position: 0px -300px;}
        .mask4{height:100px;left:95px;top:557px;background-position: 0px -450px;}
        .mask5{height:100px;left:469px;top:557px;background-position: 0px -450px;}
        .mask6{height:100px;left:841px;top:557px;background-position: 0px -450px;}
    </style>
</head>
<body leftmargin="0" topmargin="0" bottommargin="0" rightmargin="0" style="overflow:hidden; background:transparent url('images/translateBg.png') no-repeat;" onUnload="exit();">
<div id="listBody" style="position:absolute;width:1280px;height:720px;left:0px;top:0px;overflow: hidden;background: transparent none no-repeat left top;">
    <div id='mask'></div>
</div>
<div id="mask"></div>
<script typeof="javascript" type="text/javascript">
    (function(win){
        win.moviePos = {width:523,height:293,left:658,top:105};
        win.isP60 = typeof sysmisc != 'undefined';
        win.isComputer = typeof sysmisc == 'undefined' && typeof iPanel == 'undefined';
        win.isGW = typeof iPanel != 'undefined' && iPanel.eventFrame.systemId == 2;
        win.isP30 = typeof iPanel != 'undefined' && iPanel.eventFrame.systemId == 1;
        win.HD30 = typeof iPanel != 'undefined' && iPanel.eventFrame.systemId == 'undefined';
        win.EPGUrl = typeof iPanel == 'undefined' ? ( ( win.isP60 ? win.address = sysmisc.getEnv('epg_address','')  : "http://117.59.202.67:8080" ) + '/EPG/jsp') : win.isGW ? iPanelGatewayHelper.getEPGServerUrl() + 'jsp' : iPanel.eventFrame.pre_epg_url;
        var fileJS = win.isComputer ? "js/common.js"  : (win.EPGUrl + "/neirong/player/common.js");

        var __loadJS = function () {};
        win.appendJS = function(path){
            var script = document.createElement('script');
            script.src = path;
            script.type = 'text/javascript';
            document.getElementsByTagName('head')[0].appendChild(script);
        };
        var districts = decodeURIComponent('%E7%92%A7%E5%B1%B1%2C%E7%9F%B3%E6%9F%B1%2C%E6%B8%9D%E5%8C%97%2C%E5%8D%97%E5%B2%B8%2C%E4%B8%87%E5%B7%9E%2C%E5%8C%97%E7%A2%9A%2C%E6%B1%9F%E6%B4%A5%2C%E5%90%88%E5%B7%9D%2C%E6%AD%A6%E9%9A%86%2C%E5%BC%80%E5%B7%9E%2C%E4%BA%91%E9%98%B3%2C%E5%B7%AB%E6%BA%AA%2C%E5%A5%89%E8%8A%82%2C%E6%B0%B8%E5%B7%9D%2C%E7%B6%A6%E6%B1%9F%2C%E6%B2%99%E5%9D%AA%E5%9D%9D%2C%E4%B9%9D%E9%BE%99%E5%9D%A1%2C%E5%8D%97%E5%B7%9D%2C%E6%B8%9D%E4%B8%AD%2C%E5%B7%B4%E5%8D%97%2C%E6%B1%9F%E5%8C%97').split(',');
        win.exit = function(){};
        var tooltipShow = function(message) {
            message = message || decodeURIComponent('%E6%8E%88%E6%9D%83%E5%A4%B1%E8%B4%A5%2C%20%E8%AF%B7%E8%BF%94%E5%9B%9E%E5%88%B0%E6%9C%BA%E9%A1%B6%E7%9B%92%E9%A6%96%E9%A1%B5%E5%90%8E%E9%87%8D%E8%AF%95%E6%88%96%E9%87%8D%E5%90%AF%E6%9C%BA%E9%A1%B6%E7%9B%92');
            if( win.isP60 ) sysmisc.showToast(message);
            else if( win.isGW ) iPanel.debug(message);
            else alert(message);
        };
        var __evalJS = function(strJS){
            try {
                if(/^\s*\<html\>/g.test(strJS) ) { tooltipShow(); return ; }
                eval( strJS );
            } catch (e) { tooltipShow( e ); }
        };
        if( ! win.isP60 ) {
            __loadJS = function(){
                if( win.isGW ) {
                    var xhr = new XMLHttpRequest();
                    xhr.onreadystatechange = function () {
                        var state = xhr.readyState, status = xhr.status;
                        if (state === 4 && ( status == 200 || status == 204 )) __evalJS( xhr.responseText );
                    };
                    xhr.open('POST', fileJS, true);
                    xhr.send(null);
                } else { appendJS(fileJS); }
            };
        } else {
            win.AndroidHtml5 = {
                idCounter: 0,
                OUTPUT_RESULTS: {},
                CALLBACK_SUCCESS: {},
                CALLBACK_FAIL: {},
                callNative: function (cmd, type,args, success, fail) {
                    var key = "ID_" + (++this.idCounter);
                    AndroidHtml5.CALLBACK_SUCCESS[key] = typeof success != 'undefined'?  success : function (result) {};
                    AndroidHtml5.CALLBACK_FAIL[key] = typeof fail != 'undefined'?  fail : function (result) {};
                    sysmisc.async(JSON.stringify(cmd), type,JSON.stringify(args),key);
                    return this.OUTPUT_RESULTS[key];
                },
                callBackJs: function (result, type,key) {
                    if(type == "json"){
                        this.OUTPUT_RESULTS[key] = result;
                        var status = result.status;
                        if (status == 200 && typeof this.CALLBACK_SUCCESS[key] != "undefined") {
                            AndroidHtml5.CALLBACK_SUCCESS[key](result.message);
                        } else if( status != 200 && typeof this.CALLBACK_FAIL != "undefined"){
                            setTimeout("AndroidHtml5.CALLBACK_FAIL['" + key + "'](" + result.message + ")", 0);
                        }
                    }
                },
            };
            __loadJS = function () {
                var cookie = '[{"key": "cookie", "value":"' + "JSESSIONID=" + sysmisc.getEnv('sessionid', '') + '"}]';
                var o = { "url": fileJS, "method": "post", "mediatype": "text/xml", "body": null, "header": cookie };
                AndroidHtml5.callNative({ "service": "request","action": '' }, 'json',o, __evalJS ,function(e){});
            };
        }
        var initialize = {
            init : function() {
                var typeId = '10000100000000090000000000113940';
                var enc = '&enc=1';
                if( iPanel.HD30Adv ) enc = '';
                var url = EPGUrl + '/neirong/player/detail.jsp?id=' + typeId + '&act=2' + enc + '&cn=7&fn=1&spec=1';
                var focused = win.link.query('currFoucs');
                focused = focused != '' ? focused.split(',') : [];

                win.regex = new RegExp(decodeURIComponent("(%5C(%7C%EF%BC%88).*%3F(%5C)%7C%EF%BC%89)%24"), "gi");

                ajax(url,
                    function(rst){
                        var success = rst.success;
                        if( ! success ) {   //提示:请求栏目数据时，出现错误！
                            tooltip( decodeURIComponent('%E8%AF%B7%E6%B1%82%E6%A0%8F%E7%9B%AE%E6%95%B0%E6%8D%AE%E6%97%B6%EF%BC%8C%E5%87%BA%E7%8E%B0%E9%94%99%E8%AF%AF%EF%BC%81') );
                            return;
                        }
                        rst = rst.data;
                        var list = rst.list;
                        var columns = list[0].data;  //  0是样目列表
                        cursor.vodId = list[1].data;
                        var bg = cursor.pictureUrl(rst.column.posters,7,'');
                        if( !bg.isEmpty() ) {
                            $("listBody").style.backgroundImage = 'url("' + bg + '")';
                        }
                        cursor.typeId = columns[0].id;
                        if( typeof cursor.vodId != 'undefined' ) cursor.vodId = cursor.vodId[0].id;
                        cursor.blocked = focused.length > 0 ? Number(focused[0]) : 0;
                        columns.removeAt(0);
                        columns[0].linkto = 'http://192.168.89.23/active/act2020NewHikeCQBYList.html?typeId=' + columns[0].id;
                        columns[1].linkto = 'http://epgServer/neirong/shang/J20200103.jsp?typeId=10000100000000090000000000113781&lft=45&tp=415&row=1&ct=4&ht=192&wh=262&ml=0&bc=ffe200&fc=ffe200&lft=165&tp=143';
                        columns[2].linkto = 'http://125.62.26.147:82/topic/topic1.html?classId=117&rank=2&urlType=TOPIC';
                        columns[3].linkto = 'http://125.62.26.147:82/topic/topic1.html?classId=115&rank=2&urlType=TOPIC';
                        columns[4].linkto = 'http://192.168.89.23/active/act2020NewHikeCQBYList.html?typeId=' + columns[4].id;
                        columns[5].linkto = 'http://epgServer/neirong/shang/J20200106.jsp';
                        cursor.focusable[0] = { items: columns, focus : focused.length > 1 ? Number(focused[1]) : 0};
                        cursor.call('show');
                        cursor.call('playMovie');
                    }, {
                        fail:function( meg ) {
                            return;
                        }
                    }
                );
            },
            playMovie:function(){
                try{
                    player.exit();
                    player.play( {vodId: cursor.vodId, typeId: cursor.typeId, position:moviePos} );
                } catch (e){ }
            }, nextVideo : function(){
                cursor.call('playMovie');
            },
            move:function(index){
                var blocked = cursor.blocked;
                var items = cursor.focusable[blocked].items;
                var focus = cursor.focusable[blocked].focus;
                if( index == 11 && focus <= 2 || index == -11 && focus >= 3 || index == -1 && focus % 3 == 0 || index == 1 && focus % 3 == 2) return;
                if( index == 1 || index == -1 ) focus += index ;
                else focus += index == 11 ? -3 : 3;
                if( focus < 0 || focus >= items.length ) return;
                cursor.focusable[blocked].focus = focus;
                cursor.blocked = blocked;
                cursor.call('show');
            },
            show : function() {
                var blocked = cursor.blocked;
                var focus = cursor.focusable[blocked].focus;
                $("mask").className = "mask mask" + String(focus + 1 );
            }
        };
        __loadJS();
        var lazied = function(){
            if( typeof win.cursor == 'undefined') { setTimeout(function () { lazied(); }, 100 ); return; }
            cursor.initialize(initialize);
        };
        lazied();
    })(window);
</script>
</body>
</html>
